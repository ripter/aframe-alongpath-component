!function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("alongpath",{schema:{path:{"default":""},closed:{"default":!1},dur:{"default":1e3},delay:{"default":2e3},loop:{"default":!1},inspect:{"default":!0}},init:function(){this.initialPosition=this.el.getAttribute("position")},update:function(t){t.path&&t.path==this.data.path||this.createCurve(),this.data.inspect?(this.inspectorElementChanged=this.inspectorElementChanged.bind(this),this.createInspectorElements()):t.inspect===!0&&this.removeInspectorElements()},createCurve:function(){this.pathpoints=this.data.path.split(" ").map(function(t){return t=t.split(","),new THREE.Vector3(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]))});var t=new THREE.CatmullRomCurve3(this.pathpoints);t.closed=this.data.closed,this.curve=t,this.interval=0,this.el.removeState("endofpath")},tick:function(t,e){if(!this.el.is("endofpath")){this.interval=this.interval+e;var i=0;i=this.interval-this.data.delay>=this.data.dur?1:this.interval-this.data.delay<0?0:(this.interval-this.data.delay)/this.data.dur;try{if(this.data.loop===!1&&i>=1)this.el.removeState("moveonpath"),this.el.addState("endofpath"),this.data.closed?this.el.setAttribute("position",this.curve.points[0]):this.el.setAttribute("position",this.curve.points[this.curve.points.length-1]);else if(this.data.loop===!0&&i>=1)this.interval=this.data.delay;else{var s=this.curve.getPoint(i);this.el.setAttribute("position",s),this.el.is("moveonpath")||this.el.addState("moveonpath")}}catch(n){}}},remove:function(){this.el.setAttribute("position",this.initialPosition),this.removeInspectorElements()},createInspectorElements:function(){this.removeInspectorElements(),this.inspectorElements=new Array;for(var t=0;t<this.pathpoints.length;t++){var e=document.createElement("a-box"),i=this.el.sceneEl.appendChild(e);AFRAME.utils.entity.setComponentProperty(i,"position",AFRAME.utils.coordinates.stringify(this.pathpoints[t])),AFRAME.utils.entity.setComponentProperty(i,"width",.1),AFRAME.utils.entity.setComponentProperty(i,"height",.1),AFRAME.utils.entity.setComponentProperty(i,"depth",.1),AFRAME.utils.entity.setComponentProperty(i,"color","red"),i.setAttribute("className","alongpath-debug"),i.setAttribute("visible",!0),i.addEventListener("componentchanged",this.inspectorElementChanged),this.inspectorElements.push(i)}this.drawCurveLine()},drawCurveLine:function(){this.inspectorCurve&&this.inspectorCurve.parentNode.removeChild(this.inspectorCurve);var t=document.createElement("a-entity"),e=this.el.sceneEl.appendChild(t),i=new THREE.LineBasicMaterial({color:"red"}),s=new THREE.Geometry;s.vertices=this.curve.getPoints(10*this.pathpoints.length),e.setObject3D("mesh",new THREE.Line(s,i)),e.setAttribute("className","alongpath-debug"),e.setAttribute("visible",!0),this.inspectorCurve=e},removeInspectorElements:function(){if(this.inspectorElements)for(var t=0;t<this.inspectorElements.length;t++)this.inspectorElements[t].parentNode.removeChild(this.inspectorElements[t]);this.inspectorCurve&&this.inspectorCurve.parentNode.removeChild(this.inspectorCurve),this.inspectorElements=null,this.inspectorCurve=null},inspectorElementChanged:function(t){for(var e=new Array,i=0;i<this.inspectorElements.length;i++)this.inspectorElements[i].components.position.attrValue&&e.push(this.inspectorElements[i].components.position.attrValue.x+","+this.inspectorElements[i].components.position.attrValue.y+","+this.inspectorElements[i].components.position.attrValue.z);var s=e.join(" ");""!=s&&s!=this.data.path&&(this.data.path=s,this.createCurve(),this.drawCurveLine())}})}]);